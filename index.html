<!--<html>
<head>
<script src="bundle.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
  $(window).on('load', function() {
      console.log('All assets are loaded')
      //setupConstants();
      getFiles();
      $("#buttonUpload").click(function(){
        //alert("The paragraph was clicked.");
        setupFileStorage();
      });
  })


  </script>
  </head>
  <body>
    <form action="#" method="post" enctype="multipart/form-data">
    Select image to upload:
    <input type="file" name="files" id="files">
    <input type="button" value="Upload Image" name="buttonUpload" id="buttonUpload">
</form>
</body>
</html>-->
<!DOCTYPE html>
<html lang="en" >
    <!-- begin::Head -->
    <head>
        <meta charset="utf-8"/>
        <title>dTunes</title>
        <meta name="description" content="dTunes - Hosted over SKALE">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <!--begin::Fonts -->
        <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
        <script>
            WebFont.load({

                google: {
"families":[
"Poppins:300,400,500,600,700"]},

                active: function() {

                    sessionStorage.fonts = true;
                }
            });
        </script>
        <!--end::Fonts -->

        <!--begin:: Global Mandatory Vendors -->
<link href="./assets/vendors/general/perfect-scrollbar/css/perfect-scrollbar.css" rel="stylesheet" type="text/css" />
<!--end:: Global Mandatory Vendors -->

<!--begin:: Global Optional Vendors -->
<link href="./assets/vendors/general/tether/dist/css/tether.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/bootstrap-datepicker/dist/css/bootstrap-datepicker3.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/bootstrap-datetime-picker/css/bootstrap-datetimepicker.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/bootstrap-timepicker/css/bootstrap-timepicker.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/bootstrap-select/dist/css/bootstrap-select.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/nouislider/distribute/nouislider.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/owl.carousel/dist/assets/owl.carousel.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/owl.carousel/dist/assets/owl.theme.default.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/dropzone/dist/dropzone.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/summernote/dist/summernote.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/bootstrap-markdown/css/bootstrap-markdown.min.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/animate.css/animate.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/toastr/build/toastr.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/morris.js/morris.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/sweetalert2/dist/sweetalert2.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/general/socicon/css/socicon.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/custom/vendors/line-awesome/css/line-awesome.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/custom/vendors/flaticon/flaticon.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/custom/vendors/flaticon2/flaticon.css" rel="stylesheet" type="text/css" />
<link href="./assets/vendors/custom/vendors/fontawesome5/css/all.min.css" rel="stylesheet" type="text/css" />
<!--end:: Global Optional Vendors -->

<!--begin::Global Theme Styles(used by all pages) -->

        <link href="./assets/demo/demo3/base/style.bundle.css" rel="stylesheet" type="text/css" />
        <!--end::Global Theme Styles -->
        <link rel="shortcut icon" href="./images/favicon.ico" />
        <link href="css/custom-styles.css" rel="stylesheet">
    </head>
    <!-- end::Head -->
    <!-- begin::Body -->
    <body class="k-page--fixed k-header--fixed k-header--minimize-menu k-header-mobile--fixed k-subheader--enabled k-subheader--transparent k-page--loading" >
        <!-- begin::Page loader -->
        <!-- end::Page Loader -->
        <!-- begin:: Page -->
        <!-- begin:: Header Mobile -->
        <div id="k_header_mobile" class="k-header-mobile k-header-mobile--fixed " >
            <div><br/><h2>dTunes</h2></div>
            <div class="k-header-mobile__toolbar">
                <button class="k-header-mobile__toolbar-toggler" id="k_header_mobile_toggler"><span></span></button>
                <button class="k-header-mobile__toolbar-topbar-toggler" id="k_header_mobile_topbar_toggler"><i class="flaticon-more"></i></button>
            </div>
        </div>
        <!-- end:: Header Mobile -->
        <div class="k-grid k-grid--hor k-grid--root">
            <div class="k-grid__item k-grid__item--fluid k-grid k-grid--ver k-page">
                <div class="k-grid__item k-grid__item--fluid k-grid k-grid--hor k-wrapper " id="k_wrapper">
                    <!-- begin:: Header -->
                    <div id="k_header" class="k-header k-grid__item k-header--fixed " data-kheader-minimize="on" style="background-image: url(./assets/demo/demo3/media/layout/header-bg.jpg)">
                        <div class="k-header__top">
                            <div class="k-container">
                                <!-- begin:: Brand -->
                                <div class="k-header__brand k-grid__item" id="k_header_brand">
                                    <h1 style="color:white">dTunes</h1>
                                </div>
                                <!-- end:: Brand -->
                                <!-- begin:: Topbar -->
                                <div class="k-header__topbar">
                                    <!--begin: Quick Panel Toggler -->
                                    <div class="k-header__topbar-item" data-toggle="k-tooltip" title="Quick panel" data-placement="top">
                                        <div class="k-header__topbar-wrapper">
                                            <span class="k-header__topbar-icon" id="k_quick_panel_toggler_btn"><i class="flaticon-grid-menu"></i></span>
                                        </div>
                                    </div>
                                    <!--end: Quick Panel Toggler -->
                                    <!--begin: Network -->
                                    <div class="k-header__topbar-item k-header__topbar-item--langs">
                                        <div class="k-header__topbar-wrapper" data-toggle="dropdown" data-offset="20px 10px">
                                            <button type="button" class="btn btn-outline-success my-2 my-sm-0" id="networkName">
                                              Network</button>
                                        </div>

                                    </div>
                                    <!--end: Languages -->

                                </div>
                                <!-- end:: Topbar -->
                            </div>
                        </div>
                        <div class="k-header__bottom">
                            <div class="k-container">
                                <!-- begin: Header Menu -->
                                <button class="k-header-menu-wrapper-close" id="k_header_menu_mobile_close_btn"><i class="la la-close"></i></button>
                                <div class="k-header-menu-wrapper" id="k_header_menu_wrapper">
                                    <div id="k_header_menu" class="k-header-menu k-header-menu-mobile " >
                                        <ul class="k-menu__nav ">
                                          <li class="k-menu__item k-menu__item--open k-menu__item--here k-menu__item--submenu k-menu__item--rel k-menu__item--open k-menu__item--here" data-kmenu-submenu-toggle="click" aria-haspopup="true">
                                              <a href="index.html" class="k-menu__link"><span class="k-menu__link-text">File Browser</span></a>
                                          </li>
                                          <!--<li class="k-menu__item k-menu__item--open k-menu__item--here k-menu__item--submenu k-menu__item--rel k-menu__item--open k-menu__item--here" data-kmenu-submenu-toggle="click" aria-haspopup="true">
                                              <a href="orderbooks.html" class="k-menu__link"><span class="k-menu__link-text">Orderbooks</span></a>
                                          </li>-->

                                        </ul>
                                    </div>

                                </div>
                                <!-- end: Header Menu -->
                            </div>
                        </div>
                    </div>
                    <!-- end:: Header -->
                    <div class="k-grid__item k-grid__item--fluid k-grid k-grid--ver k-grid--stretch">
                        <div class="k-container k-body k-grid k-grid--ver" id="k_body">
                            <div class="k-grid__item k-grid__item--fluid k-grid k-grid--hor">
                                <!-- begin:: Subheader -->
                                <div class="k-subheader k-grid__item" id="k_subheader">
                                    <div class="k-subheader__main">

                                    </div>

                                </div>
                                <!-- end:: Subheader -->
                                <!-- begin:: Content -->
                                <div class="k-content k-grid__item k-grid__item--fluid">
                                    <!--begin::Dashboard 4-->
                                    <!--begin::Row-->
                                    <div class="alert alert-warning d-none" role="alert" id="networkAlert">
                        							<div class="alert-icon"><i class="flaticon-warning"></i></div>
                        						  	<div class="alert-text">You are on a test network! Please switch to Main Ethereum Network from your MetaMask extension to use dSwaps on the mainnet.</div>
                        						</div>
                                    <div class="alert alert-danger d-none" role="alert" id="metaMaskAlert">
                        							<div class="alert-icon"><i class="flaticon-warning"></i></div>
                        						  	<div class="alert-text">This website needs MetaMask browser extension to be installed!</div>
                        						</div>
                                    <div class="k-portlet">
                                      <div class="k-portlet__head k-portlet__head--noborder">
                                          <div class="k-portlet__head-label">
                                              <h3 class="k-portlet__head-title">
                                                  Demo with different accounts
                                              </h3>
                                          </div>
                                      </div>
                                        <div class="k-portlet__body">
                                        <form class="k-form k-form--label-right">
                                          <div class="form-group row">
                                            <div class="container">
                                              <div class="row">

                                                <div class="col">

                                                  <div class="input-group mb-3">
                                                      <select class="form-control selectpicker" id="srcAccounts" style="width:100%;display:block" name="srcAccounts" required>
                                                        <option value="0">Please select a wallet</option>
                                                        <option value="1">Wallet 1</option>
                                                        <option value="2">Wallet 2</option>
                                                      </select>


                                                  </div>


                                                </div>


                                              </div>
                                            </div>


                                        </div>
                                      </form>
                                    </div>
                                    </div>
                                    <div class="">
                                        <!--begin::Portlet-->
                                        <div class="k-portlet k-portlet--height-fluid k-widget-17">
                                            <div class="k-portlet__head">
                                                <div class="k-portlet__head-label">
                                                    <h3 class="k-portlet__head-title">
                                                        Your Music Files
                                                    </h3>
                                                </div>
                                                <div class="k-portlet__head-toolbar">
                                            <a href="#" class="btn btn-dark" data-toggle="modal" data-target="#uploadModal" id="uploadModalBtn">Upload Music</a>
                                          </div>
                                            </div>
                                            <div class="k-portlet__body">
                                                <div class="k-widget-17" id="tokenPairClass">

                                                    <!-- <div class="k-widget-17__item" id="removeThisDiv">
                                                          <div class="k-widget-17__product" >
                                                              <div class="k-widget-17__thumb">
                                                                  <a href="#">
                                                                      <img src="./images/loading.gif" class="k-widget-17__image" alt="" title="" />
                                                                  </a>
                                                              </div>
                                                              <div class="k-widget-17__product-desc">
                                                                  <a href="#">
                                                                      <div class="k-widget-17__title">  </div>
                                                                  </a>
                                                              </div>
                                                          </div>

                                                          <div class="k-widget-17__prices">
                                                            <div class="k-widget-17__unit"></div>
                                                            <div class="k-widget-17__total"></div>
                                                          </div>
                                                      </div> -->

                                                </div>
                                            </div>

                                        </div>
                                        <!--end::Portlet-->
                                    </div>

                                    <div class="">
                                        <!--begin::Portlet-->
                                        <div class="k-portlet k-portlet--height-fluid k-widget-17">
                                            <div class="k-portlet__head">
                                                <div class="k-portlet__head-label">
                                                    <h3 class="k-portlet__head-title">
                                                        Other's Music Files
                                                    </h3>
                                                </div>

                                            </div>
                                            <div class="k-portlet__body">
                                                <div class="k-widget-17" id="allFiles">


                                                    <!-- <div class="k-widget-17__item" id="removeThisDiv">
                                                          <div class="k-widget-17__product" >
                                                              <div class="k-widget-17__thumb">
                                                                  <a href="#">
                                                                      <img src="./images/loading.gif" class="k-widget-17__image" alt="" title="" />
                                                                  </a>
                                                              </div>
                                                              <div class="k-widget-17__product-desc">
                                                                  <a href="#">
                                                                      <div class="k-widget-17__title">  </div>
                                                                  </a>
                                                              </div>
                                                          </div>

                                                          <div class="k-widget-17__prices">
                                                            <div class="k-widget-17__unit"></div>
                                                            <div class="k-widget-17__total"></div>
                                                          </div>
                                                      </div> -->

                                                </div>
                                            </div>

                                        </div>
                                        <!--end::Portlet-->
                                    </div>


                                    <!--end::Row-->
                                    <!--end::Dashboard 4-->
                                </div>
                                <!-- end:: Content -->
                            </div>
                        </div>
                    </div>
                    <!-- begin:: Footer -->
                    <div class="k-footer k-grid__item" style="background-image: url(./assets/demo/demo3/media/layout/footer-bg.jpg)" id="k_footer">
                        <div class="k-container">
                            <div class="k-footer__top">
                                <div class="row">
                                    <div class="col-lg-4">
                                        <div class="k-footer__section">
                                            <h3 class="k-footer__title">
                                                About
                                            </h3>
                                            <div class="k-footer__about"> dTunes is a community developed and supported version to facilitate swap of music files using SKALE powered File Storage. </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="k-footer__section">
                                            <h3 class="k-footer__title">
                                                Grab the source code
                                            </h3>
                                            <div class="row">
                                                <div class="col">
                                                    <ul class="k-footer__nav">
                                                        <li><a href="#" class="k-link">Github</a></li>

                                                    </ul>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="k-footer__section">

                                            <div class="k-footer__social">
                                                <div class="k-footer__social-label"> Find us on Twitter: </div>
                                                <ul class="k-footer__social-nav">

                                                    <li>
                                                        <a href="#"><i class="flaticon-twitter-logo-button"></i></a>
                                                    </li>

                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="k-footer__bottom">
                                <div class="k-footer__copyright"> <a href="#" target="_blank" class="k-link">dTunes</a> </div>
                            </div>
                        </div>
                    </div>
                    <!-- end:: Footer -->
                </div>
            </div>
        </div>
        <!-- end:: Page -->
        <!-- begin:: Quick Panel -->
        <div id="k_quick_panel" class="k-offcanvas-panel">
            <div class="k-offcanvas-panel__nav">
                <ul class="nav nav-pills" role="tablist">
                    <li class="nav-item active"> <a class="nav-link active" data-toggle="tab" href="#k_quick_panel_tab_settings" role="tab">Settings</a> </li>
                </ul>
                <button class="k-offcanvas-panel__close" id="k_quick_panel_close_btn"><i class="flaticon2-delete"></i></button>
            </div>
            <div class="k-offcanvas-panel__body">
                <div class="tab-content">
                    <div class="tab-pane fade show k-offcanvas-panel__content k-scroll active" id="k_quick_panel_tab_settings" role="tabpanel">
                        <form class="k-form">
                            <div class="k-heading k-heading--space-sm">Cache</div>
                            <div class="form-group form-group-xs row">
                                <label class="col-8 col-form-label">Enable cache:</label>
                                <div class="col-4 k-align-right">
                                    <span class="k-switch k-switch--sm">
                                        <label>
                                            <input type="checkbox" checked="checked" name="quick_panel_cache_1" id="cache_button">
                                            <span></span>
                                        </label>
                                    </span>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- end:: Quick Panel -->
        <!-- begin:: Scrolltop -->
        <div id="k_scrolltop" class="k-scrolltop"> <i class="la la-arrow-up"></i> </div>
        <!-- end:: Scrolltop -->
        <!--AlertModal -->
        <div class="modal" id="alertModal" tabindex="-1" role="dialog" style="z-index:1000000001;">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="alertModalText"></h5>
                <button type="button" class="close" id="alert-cross-close-btn" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="alertModalBody" style="word-wrap: break-word;">
              </div>
              <!-- Modal footer -->
              <div class="modal-footer">
                <button type="button" id="alert-close-btn" class="btn btn-danger" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>

        <!--Success Alert-->
        <div class="modal" id="successModal" tabindex="-1" role="dialog" style="z-index:1000000001;">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="successModalText"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="successModalBody" style="word-wrap: break-word;">
              </div>
              <!-- Modal footer -->
              <div class="modal-footer">
                <button type="button" class="btn btn-info" data-dismiss="modal">OK</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal for Upload Modal -->
        <div class="modal fade bd-example-modal-lg" id="uploadModal">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">

              <!-- Modal Header -->
              <div class="modal-header">
                <h4 class="modal-title" id="orderModalTitle">Upload Music</h4>
                <button type="button" class="close" data-dismiss="modal"></button>
              </div>

              <!-- Modal body -->
              <div class="modal-body">

                <form action="#" id="uploadModalForm" autocomplete="off">
                  <input autocomplete="false" name="hidden" type="text" style="display:none;">
                  <div class="form-group">
                    <input type="file" name="files" id="files" class="btn btn-primary" required>
                  </div>
                  <button type="button" value="Upload Image" name="buttonUpload" id="buttonUpload" class="btn btn-primary">Upload</button>
                </form>
              </div>
            </div>
          </div>
        </div>


        <!-- Modal for Cancel Confirmation -->
        <div class="modal" id="confirmationModal" tabindex="-1" role="dialog" style="z-index:1000000001;">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="confirmationModalText">Confirmation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="successModalBody" style="word-wrap: break-word;">
                Are you sure want to delete this record?
              </div>
              <!-- Modal footer -->
              <div class="modal-footer">
                <button type="button" class="btn btn-default" id="modal-btn-si">Yes</button>
                <button type="button" class="btn btn-primary" id="modal-btn-no">No</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal for buy Confirmation -->
        <div class="modal" id="buyModal" tabindex="-1" role="dialog" style="z-index:1000000001;">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="confirmationModalText">Confirmation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="successModalBody" style="word-wrap: break-word;">
                Do you really want to buy this file?
              </div>
              <!-- Modal footer -->
              <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="modal-btn-yes">Yes</button>
                <button type="button" class="btn btn-default" id="modal-btn-nah">No</button>
              </div>
            </div>
          </div>
        </div>

        <!--begin:: Toast markup-->
<div class="toast toast-custom toast-fill fade hide" role="alert" aria-live="assertive" aria-atomic="true" id="k_toast_1">
	<div class="toast-header">
		<i class="toast-icon flaticon2-attention-exclamation-triangular-signal k-font-danger"></i>
		<span class="toast-title" ></span>
		<small class="toast-time"></small>
	</div>
	<div class="toast-body">
	</div>
</div>
<!--end:: Toast markup-->

        <!-- begin::Global Config(global config for global JS sciprts) -->
        <script>
            var KAppOptions = {

    "colors": {

        "state": {

            "brand": "#4d5cf2",

            "metal": "#c4c5d6",

            "light": "#ffffff",

            "accent": "#00c5dc",

            "primary": "#5867dd",

            "success": "#34bfa3",

            "info": "#36a3f7",

            "warning": "#ffb822",

            "danger": "#fd3995",

            "focus": "#9816f4"
        },

        "base": {

            "label": [

                "#c5cbe3",

                "#a1a8c3",

                "#3d4465",

                "#3e4466"
            ],

            "shape": [

                "#f0f3ff",

                "#d9dffa",

                "#afb4d4",

                "#646c9a"
            ]
        }
    }
};
        </script>
        <!-- end::Global Config -->
        <!--begin:: Global Mandatory Vendors -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"
                integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="./assets/vendors/general/popper.js/dist/umd/popper.js" type="text/javascript"></script>
<script src="./assets/vendors/general/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
<script src="./assets/vendors/general/js-cookie/src/js.cookie.js" type="text/javascript"></script>
<script src="./assets/vendors/general/moment/min/moment.min.js" type="text/javascript"></script>
<script src="./assets/vendors/general/tooltip.js/dist/umd/tooltip.min.js" type="text/javascript"></script>
<script src="./assets/vendors/general/perfect-scrollbar/dist/perfect-scrollbar.js" type="text/javascript"></script>
<script src="./assets/vendors/general/sticky-js/dist/sticky.min.js" type="text/javascript"></script>
<script src="./assets/vendors/general/wnumb/wNumb.js" type="text/javascript"></script>
<!--end:: Global Mandatory Vendors -->

<!--begin:: Global Optional Vendors -->
<script src="./assets/vendors/general/jquery-form/dist/jquery.form.min.js" type="text/javascript"></script>
<script src="./assets/vendors/custom/vendors/bootstrap-multiselectsplitter/bootstrap-multiselectsplitter.min.js" type="text/javascript"></script>
<script src="./assets/vendors/general/bootstrap-select/dist/js/bootstrap-select.js" type="text/javascript"></script>
<script src="./assets/vendors/general/toastr/build/toastr.min.js" type="text/javascript"></script>
<!--end:: Global Optional Vendors -->

<!--begin::Global Theme Bundle(used by all pages) -->

        <script src="./assets/demo/demo3/base/scripts.bundle.js" type="text/javascript"></script>
        <!--begin::Global App Bundle(used by all pages) -->
        <script src="./assets/app/scripts/bundle/app.bundle.js" type="text/javascript"></script>
        <!--end::Global App Bundle -->

        <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.34/dist/web3.min.js"></script>
        <script type="text/javascript" src="https://cdn.rawgit.com/indutny/bn.js/master/lib/bn.js"></script>
        <script src="bundle.js"></script>
        <script>
          $(window).on('load', async function() {
              console.log('All assets are loaded')
              var wallet = "";
              if (wallet == ""){
                $('#tokenPairClass').html('Please select a wallet');
                $('#allFiles').html('Please select a wallet');
              }
              //await setupWallets(1);
              getUserFiles = async function(){
                $('#tokenPairClass').html('<div id="removeThisDiv"><img src="./images/loading.gif" class="k-widget-17__image"/></div>')
                var files = await getFiles()
                //$('#removeThisDiv').remove();
                $.each( files, function( i, item ) {
                  var fileName = files[i]["name"];
                  console.log(fileName);
                  $('#removeThisDiv').remove();
                  $('#tokenPairClass').append('<div class="k-widget-17__item"><div class="k-widget-17__product" ><div class="k-widget-17__thumb"><a href="#"><img src="./images/mp3.svg" class="k-widget-17__image" alt="" title="" /></a></div><div class="k-widget-17__product-desc"><a href="#"><div class="k-widget-17__title"> '+fileName+' </div></a></div></div><div class="k-widget-17__prices"><div class="k-widget-17__unit"><button type="button" class="btn btn-primary" id="dwn_'+files[i]["storagePath"]+'" onclick="downloadMe(this.id)">Download</button></div><div class="k-widget-17__total"><button type="button" class="btn btn-danger" id="del_'+files[i]["name"]+'" onclick="deleteMe(this.id)">Delete</button></div></div></div>')
                })
              }

              getAllFiles = async function(addresses){

                var files = await getAllFilesFromStorage(addresses);
                console.log(files);
                let walletAccount = await getUserWallet();
                console.log(walletAccount);

                var index = addresses.indexOf(walletAccount);
                if (index > -1) {
                    addresses.splice(index, 1);
                }

                $('#removeThisDiv').remove();
                for (var i = 0; i< addresses.length - 1; i++){
                  var file = files[i];
                  $.each( file, async function( i, item ) {
                    var fileName = file[i]["name"];
                    console.log(fileName);

                    $('#allFiles').append('<div class="k-widget-17__item"><div class="k-widget-17__product" ><div class="k-widget-17__thumb"><a href="#"><img src="./images/mp3.svg" class="k-widget-17__image" alt="" title="" /></a></div><div class="k-widget-17__product-desc"><a href="#"><div class="k-widget-17__title"> '+fileName+' </div></a></div></div><div class="k-widget-17__prices"><div class="k-widget-17__unit"><button type="button" class="btn btn-primary" id="dwn_'+file[i]["storagePath"]+'" onclick="buyMe(this.id)">Buy</button></div></div></div>')
                  })
                }
              }

              // let addressExists = setupContract();
              // if(addressExists){
              //   console.log("addressExists");
              // }

              //getUserFiles();
              $("#buttonUpload").click(async function(){

                var fileAddress = await uploadFile();
                $("#uploadModal").remove();
                $(".modal-backdrop").remove();
                toastr.info("Uploading your file to SKALE's decentralized storage...");
              });

              deleteMe = async function(item_id){
                var fileName = item_id.substring(4);
                modalConfirm(async function(confirm){
                  if(confirm){
                    toastr.info("Deleting file...");
                    deleteFile(fileName);
                  }
                });
              }

              downloadMe = async function(item_id){
                toastr.info("Downloading file...");
                downloadFileToDesktop(item_id.substring(4));
              }

              buyMe = async function(item_id){
                var fileName = item_id.substring(4);
                buyConfirm(async function(confirm){
                  if(confirm){
                    toastr.info("Buying file...");
                    //deleteFile(fileName);
                  }
                });
              }

              var buyConfirm = function(callback){
                  $("#buyModal").modal('show');

                $("#modal-btn-yes").on("click", function(){
                  callback(true);
                  $("#buyModal").modal('hide');
                });

                $("#modal-btn-nah").on("click", function(){
                  callback(false);
                  $("#buyModal").modal('hide');
                });
              };

              var modalConfirm = function(callback){
                  $("#confirmationModal").modal('show');

                $("#modal-btn-si").on("click", function(){
                  callback(true);
                  $("#confirmationModal").modal('hide');
                });

                $("#modal-btn-no").on("click", function(){
                  callback(false);
                  $("#confirmationModal").modal('hide');
                });
              };

              $("#srcAccounts").change(async function(){
                wallet = $("#srcAccounts option:selected").text();

                if (wallet == "Wallet 1"){
                  await setupWallets(1);
                  getUserFiles();
                  $('#allFiles').html('<div id="removeThisDiv"><img src="./images/loading.gif" class="k-widget-17__image"/></div>')
                  var allAddresses = await getAllAddressesFromContract();

                  getAllFiles(allAddresses);
                }else if (wallet == "Wallet 2") {
                  await setupWallets(2);
                  getUserFiles();
                  $('#allFiles').html('<div id="removeThisDiv"><img src="./images/loading.gif" class="k-widget-17__image"/></div>')
                  var allAddresses = await getAllAddressesFromContract();

                  getAllFiles(allAddresses);
                }else{
                  $('#tokenPairClass').html('Please select a wallet');
                }
              });




          })


          </script>

    </body>
    <!-- end::Body -->
</html>
